<!DOCTYPE html>
<html lang="zh-cn">

<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <title>
  SpringBootæ•´åˆQuartz(äºŒ) Â· Phantom
</title>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="color-scheme" content="light dark">




<meta name="author" content="ZHXS">
<meta name="description" content="æ¥ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæœ¬æ–‡ä¸­å±•ç¤ºåœ¨springbooté¡¹ç›®ä¸­æ ¹æ®ç‰¹å®šéœ€æ±‚é…ç½®quartzå®šæ—¶ä»»åŠ¡ã€‚
POMæ–‡ä»¶ä¸­æ·»åŠ ä¾èµ– é“¾æ¥åˆ°æ ‡é¢˜ &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-quartz&lt;/artifactId&gt; &lt;/dependency&gt; é…ç½®ç±» StartQuartzJobListener.java é“¾æ¥åˆ°æ ‡é¢˜ é¦–å…ˆéœ€è¦æœ‰ä¸ªé…ç½®ç±»æ¥åˆå§‹åŒ–quartzï¼Œ
QuartzManager æ˜¯ quartzçš„å…·ä½“ç®¡ç†ç±»ã€‚
MyJobFactory æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„Jobå·¥å‚ç±»ï¼Œç”¨æ¥è§£å†³é»˜è®¤çš„Jobç±»ä¸æ”¯æŒspringæ³¨å…¥ã€‚ TimeTaskPlanMapper æ˜¯å…·ä½“çš„ä¸šåŠ¡Mapperæ¥å£ç”¨æ¥æŸ¥è¯¢æ•°æ®åº“ä¸­çš„é…ç½®ã€‚
@Configuration public class StartQuartzJobListener implements ApplicationListener&lt;ContextRefreshedEvent&gt; { private static final Logger logger = LoggerFactory.getLogger(StartQuartzJobListener.class); /* quartz */ @Autowired private QuartzManager quartzManager; @Autowired private MyJobFactory myJobFactory; @Resource private TimeTaskPlanMapper ttpm; /** * åˆå§‹å¯åŠ¨quartz */ @Override public void onApplicationEvent(ContextRefreshedEvent event) { try { logger.debug(&#34;æŸ¥è¯¢é…ç½®è¡¨ä¸­å¯åŠ¨çš„å®šæ—¶ä»»åŠ¡é›†åˆ&#34;); // ä»æ•°æ®åº“æŸ¥è¯¢å®šæ—¶ä»»åŠ¡åˆ—è¡¨ List&lt;UpperCaseMap&gt; tasklist = ttpm.getTimeTasks(); for (UpperCaseMap upperCaseMap : tasklist) { int task_plan_code = (int) upperCaseMap.">
<meta name="keywords" content="blog,developer,personal">

<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="SpringBootæ•´åˆQuartz(äºŒ)"/>
<meta name="twitter:description" content="æ¥ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæœ¬æ–‡ä¸­å±•ç¤ºåœ¨springbooté¡¹ç›®ä¸­æ ¹æ®ç‰¹å®šéœ€æ±‚é…ç½®quartzå®šæ—¶ä»»åŠ¡ã€‚
POMæ–‡ä»¶ä¸­æ·»åŠ ä¾èµ– é“¾æ¥åˆ°æ ‡é¢˜ &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-quartz&lt;/artifactId&gt; &lt;/dependency&gt; é…ç½®ç±» StartQuartzJobListener.java é“¾æ¥åˆ°æ ‡é¢˜ é¦–å…ˆéœ€è¦æœ‰ä¸ªé…ç½®ç±»æ¥åˆå§‹åŒ–quartzï¼Œ
QuartzManager æ˜¯ quartzçš„å…·ä½“ç®¡ç†ç±»ã€‚
MyJobFactory æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„Jobå·¥å‚ç±»ï¼Œç”¨æ¥è§£å†³é»˜è®¤çš„Jobç±»ä¸æ”¯æŒspringæ³¨å…¥ã€‚ TimeTaskPlanMapper æ˜¯å…·ä½“çš„ä¸šåŠ¡Mapperæ¥å£ç”¨æ¥æŸ¥è¯¢æ•°æ®åº“ä¸­çš„é…ç½®ã€‚
@Configuration public class StartQuartzJobListener implements ApplicationListener&lt;ContextRefreshedEvent&gt; { private static final Logger logger = LoggerFactory.getLogger(StartQuartzJobListener.class); /* quartz */ @Autowired private QuartzManager quartzManager; @Autowired private MyJobFactory myJobFactory; @Resource private TimeTaskPlanMapper ttpm; /** * åˆå§‹å¯åŠ¨quartz */ @Override public void onApplicationEvent(ContextRefreshedEvent event) { try { logger.debug(&#34;æŸ¥è¯¢é…ç½®è¡¨ä¸­å¯åŠ¨çš„å®šæ—¶ä»»åŠ¡é›†åˆ&#34;); // ä»æ•°æ®åº“æŸ¥è¯¢å®šæ—¶ä»»åŠ¡åˆ—è¡¨ List&lt;UpperCaseMap&gt; tasklist = ttpm.getTimeTasks(); for (UpperCaseMap upperCaseMap : tasklist) { int task_plan_code = (int) upperCaseMap."/>

<meta property="og:title" content="SpringBootæ•´åˆQuartz(äºŒ)" />
<meta property="og:description" content="æ¥ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæœ¬æ–‡ä¸­å±•ç¤ºåœ¨springbooté¡¹ç›®ä¸­æ ¹æ®ç‰¹å®šéœ€æ±‚é…ç½®quartzå®šæ—¶ä»»åŠ¡ã€‚
POMæ–‡ä»¶ä¸­æ·»åŠ ä¾èµ– é“¾æ¥åˆ°æ ‡é¢˜ &lt;dependency&gt; &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt; &lt;artifactId&gt;spring-boot-starter-quartz&lt;/artifactId&gt; &lt;/dependency&gt; é…ç½®ç±» StartQuartzJobListener.java é“¾æ¥åˆ°æ ‡é¢˜ é¦–å…ˆéœ€è¦æœ‰ä¸ªé…ç½®ç±»æ¥åˆå§‹åŒ–quartzï¼Œ
QuartzManager æ˜¯ quartzçš„å…·ä½“ç®¡ç†ç±»ã€‚
MyJobFactory æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„Jobå·¥å‚ç±»ï¼Œç”¨æ¥è§£å†³é»˜è®¤çš„Jobç±»ä¸æ”¯æŒspringæ³¨å…¥ã€‚ TimeTaskPlanMapper æ˜¯å…·ä½“çš„ä¸šåŠ¡Mapperæ¥å£ç”¨æ¥æŸ¥è¯¢æ•°æ®åº“ä¸­çš„é…ç½®ã€‚
@Configuration public class StartQuartzJobListener implements ApplicationListener&lt;ContextRefreshedEvent&gt; { private static final Logger logger = LoggerFactory.getLogger(StartQuartzJobListener.class); /* quartz */ @Autowired private QuartzManager quartzManager; @Autowired private MyJobFactory myJobFactory; @Resource private TimeTaskPlanMapper ttpm; /** * åˆå§‹å¯åŠ¨quartz */ @Override public void onApplicationEvent(ContextRefreshedEvent event) { try { logger.debug(&#34;æŸ¥è¯¢é…ç½®è¡¨ä¸­å¯åŠ¨çš„å®šæ—¶ä»»åŠ¡é›†åˆ&#34;); // ä»æ•°æ®åº“æŸ¥è¯¢å®šæ—¶ä»»åŠ¡åˆ—è¡¨ List&lt;UpperCaseMap&gt; tasklist = ttpm.getTimeTasks(); for (UpperCaseMap upperCaseMap : tasklist) { int task_plan_code = (int) upperCaseMap." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://localhost:1313/posts/springbootquartz2/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2019-07-04T15:32:11+00:00" />
<meta property="article:modified_time" content="2019-07-04T15:32:11+00:00" />





<link rel="canonical" href="http://localhost:1313/posts/springbootquartz2/">


<link rel="preload" href="/fonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin>
<link rel="preload" href="/fonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin>


  
  
  <link rel="stylesheet" href="/css/coder.css" media="screen">






  
    
    
    <link rel="stylesheet" href="/css/coder-dark.css" media="screen">
  



 




<link rel="icon" type="image/svg+xml" href="/images/favicon.jpeg" sizes="any">
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16">

<link rel="apple-touch-icon" href="/images/apple-touch-icon.png">
<link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="manifest" href="/site.webmanifest">
<link rel="mask-icon" href="/images/safari-pinned-tab.svg" color="#5bbad5">









</head>






<body class="preload-transitions colorscheme-auto">
  
<div class="float-container">
    <a id="dark-mode-toggle" class="colorscheme-toggle">
        <i class="fa-solid fa-adjust fa-fw" aria-hidden="true"></i>
    </a>
</div>


  <main class="wrapper">
    <nav class="navigation">
  <section class="container">
    
    <a class="navigation-title" href="http://localhost:1313/">
      Phantom
    </a>
    
    
      <input type="checkbox" id="menu-toggle" />
      <label class="menu-button float-right" for="menu-toggle">
        <i class="fa-solid fa-bars fa-fw" aria-hidden="true"></i>
      </label>
      <ul class="navigation-list">
        
          
            <li class="navigation-item">
              <a class="navigation-link " href="/about/">å…³äºæœ¬ç«™</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/categories/">åˆ†ç±»</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/posts/">åšå®¢</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/tags/">æ ‡ç­¾</a>
            </li>
          
            <li class="navigation-item">
              <a class="navigation-link " href="/contact/">è”ç³»ä½œè€…</a>
            </li>
          
        
        
          
          
          
            
          
            
              
                <li class="navigation-item menu-separator">
                  <span>|</span>
                </li>
                
              
              <li class="navigation-item">
                <a href="/en/">ğŸ‡¬ğŸ‡§</a>
              </li>
            
          
        
      </ul>
    
  </section>
</nav>


    <div class="content">
      
  <section class="container post">
    <article>
      <header>
        <div class="post-title">
          <h1 class="title">
            <a class="title-link" href="http://localhost:1313/posts/springbootquartz2/">
              SpringBootæ•´åˆQuartz(äºŒ)
            </a>
          </h1>
        </div>
        <div class="post-meta">
          <div class="date">
            <span class="posted-on">
              <i class="fa-solid fa-calendar" aria-hidden="true"></i>
              <time datetime="2019-07-04T15:32:11Z">
                July 4, 2019
              </time>
            </span>
            <span class="reading-time">
              <i class="fa-solid fa-clock" aria-hidden="true"></i>
              é˜…è¯»æ—¶é—´ï¼š3 åˆ†é’Ÿ
            </span>
          </div>
          
          <div class="categories">
  <i class="fa-solid fa-folder" aria-hidden="true"></i>
    <a href="/categories/springboot/">SpringBoot</a></div>

          <div class="tags">
  <i class="fa-solid fa-tag" aria-hidden="true"></i>
    <span class="tag">
      <a href="/tags/quartz/">Quartz</a>
    </span></div>

        </div>
      </header>

      <div class="post-content">
        
        <p>æ¥ä¸Šä¸€ç¯‡æ–‡ç« ï¼Œæœ¬æ–‡ä¸­å±•ç¤ºåœ¨springbooté¡¹ç›®ä¸­æ ¹æ®ç‰¹å®šéœ€æ±‚é…ç½®quartzå®šæ—¶ä»»åŠ¡ã€‚</p>
<h2 id="pomæ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–">
  POMæ–‡ä»¶ä¸­æ·»åŠ ä¾èµ–
  <a class="heading-link" href="#pom%e6%96%87%e4%bb%b6%e4%b8%ad%e6%b7%bb%e5%8a%a0%e4%be%9d%e8%b5%96">
    <i class="fa-solid fa-link" aria-hidden="true" title="é“¾æ¥åˆ°æ ‡é¢˜"></i>
    <span class="sr-only">é“¾æ¥åˆ°æ ‡é¢˜</span>
  </a>
</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">	<span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-quartz<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></div><h2 id="é…ç½®ç±»-startquartzjoblistenerjava">
  é…ç½®ç±» StartQuartzJobListener.java
  <a class="heading-link" href="#%e9%85%8d%e7%bd%ae%e7%b1%bb-startquartzjoblistenerjava">
    <i class="fa-solid fa-link" aria-hidden="true" title="é“¾æ¥åˆ°æ ‡é¢˜"></i>
    <span class="sr-only">é“¾æ¥åˆ°æ ‡é¢˜</span>
  </a>
</h2>
<p>é¦–å…ˆéœ€è¦æœ‰ä¸ªé…ç½®ç±»æ¥åˆå§‹åŒ–quartzï¼Œ<br>
QuartzManager æ˜¯ quartzçš„å…·ä½“ç®¡ç†ç±»ã€‚<br>
MyJobFactory æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„Jobå·¥å‚ç±»ï¼Œç”¨æ¥è§£å†³é»˜è®¤çš„Jobç±»ä¸æ”¯æŒspringæ³¨å…¥ã€‚
TimeTaskPlanMapper æ˜¯å…·ä½“çš„ä¸šåŠ¡Mapperæ¥å£ç”¨æ¥æŸ¥è¯¢æ•°æ®åº“ä¸­çš„é…ç½®ã€‚</p>
<!-- more -->
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">	</span><span class="nd">@Configuration</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">StartQuartzJobListener</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ApplicationListener</span><span class="o">&lt;</span><span class="n">ContextRefreshedEvent</span><span class="o">&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">StartQuartzJobListener</span><span class="p">.</span><span class="na">class</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="cm">/* quartz */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="nd">@Autowired</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="kd">private</span><span class="w"> </span><span class="n">QuartzManager</span><span class="w"> </span><span class="n">quartzManager</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="nd">@Autowired</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="kd">private</span><span class="w"> </span><span class="n">MyJobFactory</span><span class="w"> </span><span class="n">myJobFactory</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="nd">@Resource</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">private</span><span class="w"> </span><span class="n">TimeTaskPlanMapper</span><span class="w"> </span><span class="n">ttpm</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">	     * åˆå§‹å¯åŠ¨quartz
</span></span></span><span class="line"><span class="cl"><span class="cm">	     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">onApplicationEvent</span><span class="p">(</span><span class="n">ContextRefreshedEvent</span><span class="w"> </span><span class="n">event</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        	</span><span class="n">logger</span><span class="p">.</span><span class="na">debug</span><span class="p">(</span><span class="s">&#34;æŸ¥è¯¢é…ç½®è¡¨ä¸­å¯åŠ¨çš„å®šæ—¶ä»»åŠ¡é›†åˆ&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        	</span><span class="c1">// ä»æ•°æ®åº“æŸ¥è¯¢å®šæ—¶ä»»åŠ¡åˆ—è¡¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		    	</span><span class="n">List</span><span class="o">&lt;</span><span class="n">UpperCaseMap</span><span class="o">&gt;</span><span class="w"> </span><span class="n">tasklist</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ttpm</span><span class="p">.</span><span class="na">getTimeTasks</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		    	</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">UpperCaseMap</span><span class="w"> </span><span class="n">upperCaseMap</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">tasklist</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		    		</span><span class="kt">int</span><span class="w"> </span><span class="n">task_plan_code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="n">upperCaseMap</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&#34;task_plan_code&#34;</span><span class="p">);</span><span class="w"> </span><span class="c1">// xxx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		    		</span><span class="n">String</span><span class="w"> </span><span class="n">task_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">upperCaseMap</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&#34;task_id&#34;</span><span class="p">);</span><span class="w">  </span><span class="c1">// xxx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		    		</span><span class="n">String</span><span class="w"> </span><span class="n">model_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">upperCaseMap</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&#34;model_name&#34;</span><span class="p">);</span><span class="w"> </span><span class="c1">// xxx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="kt">int</span><span class="w"> </span><span class="n">repeat_interval</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="kt">int</span><span class="p">)</span><span class="w"> </span><span class="n">upperCaseMap</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&#34;repeat_interval&#34;</span><span class="p">);</span><span class="c1">// xxx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">String</span><span class="w"> </span><span class="n">unit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">upperCaseMap</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&#34;unit&#34;</span><span class="p">);</span><span class="c1">// xxx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">Date</span><span class="w"> </span><span class="n">start_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Date</span><span class="p">)</span><span class="w"> </span><span class="n">upperCaseMap</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&#34;start_time&#34;</span><span class="p">);</span><span class="c1">// xxx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">Date</span><span class="w"> </span><span class="n">end_time</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">Date</span><span class="p">)</span><span class="w"> </span><span class="n">upperCaseMap</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="s">&#34;end_time&#34;</span><span class="p">);</span><span class="c1">// xxx</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">quartzManager</span><span class="p">.</span><span class="na">startJob</span><span class="p">(</span><span class="n">task_plan_code</span><span class="p">,</span><span class="n">task_id</span><span class="p">,</span><span class="n">model_name</span><span class="p">,</span><span class="n">repeat_interval</span><span class="p">,</span><span class="n">unit</span><span class="p">,</span><span class="n">start_time</span><span class="p">,</span><span class="n">end_time</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&#34;é¡¹ç›®åˆå§‹åŒ–å®šæ—¶ä»»åŠ¡å·²ç»å¯åŠ¨...å®šæ—¶ä»»åŠ¡ç¼–å·&#34;</span><span class="o">+</span><span class="n">task_id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		    	</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">SchedulerException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	            </span><span class="n">e</span><span class="p">.</span><span class="na">printStackTrace</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">	     * @title:ä¿®æ”¹é»˜è®¤çš„jobFactory æ”¯æŒJobä¸­æ³¨å…¥
</span></span></span><span class="line"><span class="cl"><span class="cm">	     * @author:zhangxueshan
</span></span></span><span class="line"><span class="cl"><span class="cm">	     * @date 2019å¹´6æœˆ20æ—¥ ä¸‹åˆ4:19:06
</span></span></span><span class="line"><span class="cl"><span class="cm">	     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="nd">@Bean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="kd">public</span><span class="w"> </span><span class="n">SchedulerFactoryBean</span><span class="w"> </span><span class="nf">schedulerFactoryBean</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="n">SchedulerFactoryBean</span><span class="w"> </span><span class="n">factoryBean</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SchedulerFactoryBean</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="n">factoryBean</span><span class="p">.</span><span class="na">setOverwriteExistingJobs</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="c1">//å»¶æ—¶å¯åŠ¨20ç§’</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="n">factoryBean</span><span class="p">.</span><span class="na">setStartupDelay</span><span class="p">(</span><span class="n">20</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="n">factoryBean</span><span class="p">.</span><span class="na">setJobFactory</span><span class="p">(</span><span class="n">myJobFactory</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="k">return</span><span class="w"> </span><span class="n">factoryBean</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">	     * åˆå§‹æ³¨å…¥scheduler
</span></span></span><span class="line"><span class="cl"><span class="cm">	     * @return
</span></span></span><span class="line"><span class="cl"><span class="cm">	     * @throws SchedulerException
</span></span></span><span class="line"><span class="cl"><span class="cm">	     */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="nd">@Bean</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;scheduler&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="kd">public</span><span class="w"> </span><span class="n">Scheduler</span><span class="w"> </span><span class="nf">scheduler</span><span class="p">(){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	        </span><span class="k">return</span><span class="w"> </span><span class="n">schedulerFactoryBean</span><span class="p">().</span><span class="na">getScheduler</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	    
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h2 id="quartzå®šæ—¶ä»»åŠ¡ç®¡ç†ç±»-quartzmanagerjava">
  Quartzå®šæ—¶ä»»åŠ¡ç®¡ç†ç±» QuartzManager.java
  <a class="heading-link" href="#quartz%e5%ae%9a%e6%97%b6%e4%bb%bb%e5%8a%a1%e7%ae%a1%e7%90%86%e7%b1%bb-quartzmanagerjava">
    <i class="fa-solid fa-link" aria-hidden="true" title="é“¾æ¥åˆ°æ ‡é¢˜"></i>
    <span class="sr-only">é“¾æ¥åˆ°æ ‡é¢˜</span>
  </a>
</h2>
<p>çœŸæ­£å¯åŠ¨quartzçš„ç±»ï¼ŒåŒ…æ‹¬å¯åŠ¨ç§»é™¤</p>
<p>startJobDemoä¸­çš„æ˜¯æˆ‘ä»¬éœ€è¦åœ¨ä»»åŠ¡å¯åŠ¨çš„æ—¶å€™ä¼ å…¥çš„ä¸€äº›å‚æ•°ä»¥åŠæŒ‡å®šä»»åŠ¡çš„åˆ†ç»„åç§°ã€ä»¥åŠä½¿ç”¨å“ªç§è§¦å‘å™¨ã€‚<br>
å…·ä½“çš„è§¦å‘å™¨çš„åˆ›å»ºå¯ä»¥æ ¹æ®éœ€æ±‚æ¢æˆä¸åŒçš„è§¦å‘å™¨ä»¥åº”å¯¹ä¸åŒçš„éœ€æ±‚åœºæ™¯ã€‚</p>
<p><strong><font color="red">éœ€è¦æ³¨æ„çš„ä¸€ç‚¹</font></strong>ï¼Œåœ¨æˆ‘ä»¬åˆ›å»ºè§¦å‘å™¨çš„æ—¶å€™ï¼Œè§¦å‘å™¨é»˜è®¤æœ‰ä¸€ä¸ªé”™å¤±è§¦å‘æœºåˆ¶ï¼Œä¹Ÿå°±æ˜¯å¦‚æœå¯åŠ¨å®šæ—¶ä»»åŠ¡çš„æ—¶é—´æ¯”å¼€å§‹æ—¶é—´æ™šä¸”æ²¡æœ‰è¶…è¿‡ç»“æŸæ—¶é—´ï¼Œå°±ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡ï¼Œè¿™æ ·çš„è¯è·Ÿå…·ä¸šåŠ¡çš„ä¸åŒé€‰æ‹©æ˜¯å¦å–æ¶ˆï¼Œå› ä¸ºæˆ‘ä»¬çš„é¡¹ç›®é‡Œä¸éœ€è¦è¡¥è·‘å®šæ—¶ï¼Œæ‰€ä»¥æˆ‘æŠŠè¿™ä¸ªå–æ¶ˆæ‰äº†ï¼Œå¦åˆ™åœ¨å®šæ—¶å¯åŠ¨çš„æ—¶å€™æœ‰æ—¶ä¼šç«‹é©¬æ‰§è¡Œä¸€æ¬¡ã€‚</p>
<p><strong><font color="red">ä¸åŒçš„è§¦å‘å™¨ä¼šæœ‰ä¸åŒçš„æ–¹æ³•ï¼Œæˆ‘è¿™é‡Œä½¿ç”¨CalendarIntervalScheduleBuilderçš„withMisfireHandlingInstructionDoNothing()æ–¹æ³•æ¥å…³é—­é”™å¤±æ‰§è¡Œã€‚</font></strong></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="w">	</span><span class="nd">@Component</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">QuartzManager</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">Logger</span><span class="w"> </span><span class="n">logger</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">LoggerFactory</span><span class="p">.</span><span class="na">getLogger</span><span class="p">(</span><span class="n">QuartzManager</span><span class="p">.</span><span class="na">class</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="cm">/* æ³¨å…¥å®šæ—¶å™¨å®ä¾‹ */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@Autowired</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">private</span><span class="w"> </span><span class="n">Scheduler</span><span class="w"> </span><span class="n">scheduler</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="cm">/* å‚æ•°å¯ä»¥è°ƒæ•´ æŒ‰å®é™…ä¸šåŠ¡éœ€æ±‚ */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">startJob</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">task_plan_code</span><span class="p">,</span><span class="n">String</span><span class="w"> </span><span class="n">task_id</span><span class="p">,</span><span class="n">String</span><span class="w"> </span><span class="n">model_name</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">repeat_interval</span><span class="p">,</span><span class="n">String</span><span class="w"> </span><span class="n">unit</span><span class="p">,</span><span class="n">Date</span><span class="w"> </span><span class="n">start_time</span><span class="p">,</span><span class="n">Date</span><span class="w"> </span><span class="n">end_time</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">SchedulerException</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="c1">// æ³¨å…¥å®šæ—¶ä»»åŠ¡ç±» ä¼ é€’å‚æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">startJobDemo</span><span class="p">(</span><span class="n">scheduler</span><span class="p">,</span><span class="n">task_plan_code</span><span class="p">,</span><span class="n">task_id</span><span class="p">,</span><span class="n">model_name</span><span class="p">,</span><span class="n">repeat_interval</span><span class="p">,</span><span class="n">unit</span><span class="p">,</span><span class="n">start_time</span><span class="p">,</span><span class="n">end_time</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="c1">// å¼€å¯å®šæ—¶ä»»åŠ¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">startJobDemo</span><span class="p">(</span><span class="n">Scheduler</span><span class="w"> </span><span class="n">scheduler</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">task_plan_code</span><span class="p">,</span><span class="n">String</span><span class="w"> </span><span class="n">task_id</span><span class="p">,</span><span class="n">String</span><span class="w"> </span><span class="n">model_name</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">repeat_interval</span><span class="p">,</span><span class="n">String</span><span class="w"> </span><span class="n">unit</span><span class="p">,</span><span class="n">Date</span><span class="w"> </span><span class="n">start_time</span><span class="p">,</span><span class="n">Date</span><span class="w"> </span><span class="n">end_time</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">SchedulerException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="c1">// æŸ¥è¯¢å®šæ—¶ä»»åŠ¡æ˜¯å¦å·²ç»å¯åŠ¨ å·²ç»å¯åŠ¨å…ˆåœç”¨åœ¨é‡å¯</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="kt">boolean</span><span class="w"> </span><span class="n">checkExists</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">checkExists</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span><span class="s">&#34;group1&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">checkExists</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&#34;å®šæ—¶ä»»åŠ¡å·²å­˜åœ¨ ç§»é™¤å®šæ—¶ä»»åŠ¡ å¹¶é‡å¯..ä»»åŠ¡ç¼–å·ï¼š&#34;</span><span class="o">+</span><span class="n">task_id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">removeJob</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span><span class="s">&#34;group1&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="c1">// é€šè¿‡JobBuilderæ„å»ºJobDetailå®ä¾‹ï¼ŒJobDetailè§„å®šåªèƒ½æ˜¯å®ç°Jobæ¥å£çš„å®ä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="c1">// JobDetail æ˜¯å…·ä½“Jobå®ä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">JobDetail</span><span class="w"> </span><span class="n">jobDetail</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">JobBuilder</span><span class="p">.</span><span class="na">newJob</span><span class="p">(</span><span class="n">QuartzJob</span><span class="p">.</span><span class="na">class</span><span class="p">).</span><span class="na">withIdentity</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;group1&#34;</span><span class="p">).</span><span class="na">build</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="c1">// å‘jobDetailä¼ å‚æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">jobDetail</span><span class="p">.</span><span class="na">getJobDataMap</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;task_plan_code&#34;</span><span class="p">,</span><span class="n">task_plan_code</span><span class="p">);</span><span class="w"> </span><span class="c1">// éœ€è¦ä¼ é€’åˆ° jobä¸­çš„å‚æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">jobDetail</span><span class="p">.</span><span class="na">getJobDataMap</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;task_id&#34;</span><span class="p">,</span><span class="n">task_id</span><span class="p">);</span><span class="w"> </span><span class="c1">// éœ€è¦ä¼ é€’åˆ° jobä¸­çš„å‚æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">jobDetail</span><span class="p">.</span><span class="na">getJobDataMap</span><span class="p">().</span><span class="na">put</span><span class="p">(</span><span class="s">&#34;model_name&#34;</span><span class="p">,</span><span class="n">model_name</span><span class="p">);</span><span class="w"> </span><span class="c1">// éœ€è¦ä¼ é€’åˆ° jobä¸­çš„å‚æ•°</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="c1">// è·å–åŸºäºæ—¶é—´æ®µçš„è§¦å‘å™¨ CalendarIntervalTrigger</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">CalendarIntervalScheduleBuilder</span><span class="w"> </span><span class="n">calendarIntervalSchedule</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">setInterval</span><span class="p">(</span><span class="n">unit</span><span class="p">,</span><span class="n">repeat_interval</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="c1">// TriggerBuilder ç”¨äºæ„å»ºè§¦å‘å™¨å®ä¾‹</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="c1">// è§¦å‘å™¨ ç»§æ‰¿äºTrigger</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">CalendarIntervalTrigger</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TriggerBuilder</span><span class="p">.</span><span class="na">newTrigger</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="p">.</span><span class="na">startAt</span><span class="p">(</span><span class="n">start_time</span><span class="p">)</span><span class="w">    </span><span class="c1">// å¼€å§‹æ—¶é—´</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="p">.</span><span class="na">endAt</span><span class="p">(</span><span class="n">end_time</span><span class="p">)</span><span class="w">        </span><span class="c1">// ç»“æŸæ—¶é—´</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="p">.</span><span class="na">withIdentity</span><span class="p">(</span><span class="n">task_id</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;group1&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="p">.</span><span class="na">withSchedule</span><span class="p">(</span><span class="n">calendarIntervalSchedule</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="p">.</span><span class="na">build</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">scheduler</span><span class="p">.</span><span class="na">scheduleJob</span><span class="p">(</span><span class="n">jobDetail</span><span class="p">,</span><span class="w"> </span><span class="n">build</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">scheduler</span><span class="p">.</span><span class="na">start</span><span class="p">();</span><span class="w"> </span><span class="c1">// å¯åŠ¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&#34;å¼€å§‹å¯åŠ¨å®šæ—¶ä»»åŠ¡...å®šæ—¶ä»»åŠ¡ç¼–å·ï¼š&#34;</span><span class="o">+</span><span class="n">task_id</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="c1">// é€šè¿‡é—´éš”æ—¶é—´å•ä½æ¥è®¾ç½®é—´éš”æ—¶é—´  è¿”å›å·¥å‚å¯¹è±¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="c1">// æ ¹æ®ä¸šåŠ¡è®¾å®š æœˆå‘¨æ—¥å°æ—¶åˆ†é’Ÿç§’çš„æ—¶é—´é—´éš”</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="n">CalendarIntervalScheduleBuilder</span><span class="w"> </span><span class="nf">setInterval</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">unit</span><span class="p">,</span><span class="kt">int</span><span class="w"> </span><span class="n">repeat_interval</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">CalendarIntervalScheduleBuilder</span><span class="w"> </span><span class="n">c</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CalendarIntervalScheduleBuilder</span><span class="p">.</span><span class="na">calendarIntervalSchedule</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">switch</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="k">case</span><span class="w"> </span><span class="s">&#34;s&#34;</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">c</span><span class="p">.</span><span class="na">withIntervalInSeconds</span><span class="p">(</span><span class="n">repeat_interval</span><span class="p">);</span><span class="c1">// ç§’</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="k">case</span><span class="w"> </span><span class="s">&#34;ms&#34;</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">c</span><span class="p">.</span><span class="na">withIntervalInMinutes</span><span class="p">(</span><span class="n">repeat_interval</span><span class="p">);</span><span class="c1">// åˆ†é’Ÿ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="k">case</span><span class="w"> </span><span class="s">&#34;h&#34;</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">c</span><span class="p">.</span><span class="na">withIntervalInHours</span><span class="p">(</span><span class="n">repeat_interval</span><span class="p">);</span><span class="c1">// å°æ—¶</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="k">case</span><span class="w"> </span><span class="s">&#34;d&#34;</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">c</span><span class="p">.</span><span class="na">withIntervalInDays</span><span class="p">(</span><span class="n">repeat_interval</span><span class="p">);</span><span class="w"> </span><span class="c1">// æ—¥</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="k">case</span><span class="w"> </span><span class="s">&#34;m&#34;</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">c</span><span class="p">.</span><span class="na">withIntervalInMonths</span><span class="p">(</span><span class="n">repeat_interval</span><span class="p">);</span><span class="c1">// æœˆ</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="k">case</span><span class="w"> </span><span class="s">&#34;w&#34;</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">c</span><span class="p">.</span><span class="na">withIntervalInWeeks</span><span class="p">(</span><span class="n">repeat_interval</span><span class="p">);</span><span class="c1">// å‘¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="k">break</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="c1">// å…³é—­é”™å¤±æ‰§è¡Œ  é˜²æ­¢å¯åŠ¨å®šæ—¶çš„æ—¶å€™ å¼€å§‹æ—¶é—´å·²ç»è¿‡å»ä¼šè‡ªåŠ¨æ‰§è¡Œä¸€æ¬¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">c</span><span class="p">.</span><span class="na">withMisfireHandlingInstructionDoNothing</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="c1">// é€šè¿‡cronè¡¨è¾¾å¼æ¥ç”Ÿæˆå®šæ—¶  è¿”å›å·¥å‚å¯¹è±¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="n">CronScheduleBuilder</span><span class="w"> </span><span class="nf">setIntervalByCron</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">cron</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">CronScheduleBuilder</span><span class="w"> </span><span class="n">cronScheduleBuilder</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">CronScheduleBuilder</span><span class="p">.</span><span class="na">cronSchedule</span><span class="p">(</span><span class="n">cron</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">cronScheduleBuilder</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="c1">// ç§»é™¤å®šæ—¶ä»»åŠ¡</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">removeJob</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">jobName</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">groupName</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">logger</span><span class="p">.</span><span class="na">info</span><span class="p">(</span><span class="s">&#34;å¼€å§‹åœç”¨xxxï¼š&#34;</span><span class="o">+</span><span class="n">jobName</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">TriggerKey</span><span class="w"> </span><span class="n">triggerKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TriggerKey</span><span class="p">.</span><span class="na">triggerKey</span><span class="p">(</span><span class="n">jobName</span><span class="p">,</span><span class="w"> </span><span class="n">groupName</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">checkExists</span><span class="p">(</span><span class="n">jobName</span><span class="p">,</span><span class="w"> </span><span class="n">groupName</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">scheduler</span><span class="p">.</span><span class="na">pauseTrigger</span><span class="p">(</span><span class="n">triggerKey</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">scheduler</span><span class="p">.</span><span class="na">unscheduleJob</span><span class="p">(</span><span class="n">triggerKey</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">Exception</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">(</span><span class="n">e</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="c1">// æŸ¥è¯¢å®šæ—¶æ˜¯å¦å­˜åœ¨</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">checkExists</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">jobName</span><span class="p">,</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">groupName</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">SchedulerException</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">TriggerKey</span><span class="w"> </span><span class="n">triggerKey</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">TriggerKey</span><span class="p">.</span><span class="na">triggerKey</span><span class="p">(</span><span class="n">jobName</span><span class="p">,</span><span class="w"> </span><span class="n">groupName</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">scheduler</span><span class="p">.</span><span class="na">checkExists</span><span class="p">(</span><span class="n">triggerKey</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div>
      </div>


      <footer>
        


        
        
        
        
        

        
      </footer>
    </article>

    
  </section>

    </div>

    <footer class="footer">
  <section class="container">
    Â©
    
      2019 -
    
    2024
     ZHXS 
    Â·
    
    æŠ€æœ¯æ”¯æŒ <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> & <a href="https://github.com/luizdepra/hugo-coder/" target="_blank" rel="noopener">Coder</a>.
    
  </section>
</footer>

  </main>

  

  
  
  <script src="/js/coder.js"></script>
  

  

  


  

  

  

  

  

  

  

  

  

  

  

  

  

  

  
</body>

</html>
